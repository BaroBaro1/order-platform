<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ§Ø¬Ø±</title>
  <style>
    body {
      background:#f4f4f9;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    /* ===== NAVBAR ===== */
    .navbar {
      background:#1f2937;
      color:white;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:12px 20px;
    }

    .nav-left {
      font-weight:bold;
      font-size:18px;
    }

    .nav-links a {
      color:white;
      text-decoration:none;
      margin-left:15px;
      padding:6px 10px;
      border-radius:5px;
    }

    .nav-links a:hover {
      background:#374151;
    }

    /* ===== CONTAINER ===== */
    .container {
      max-width: 900px;
      margin: 30px auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,.1);
    }

    h2 { text-align:center; }

    .top-actions {
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom:15px;
    }

    .add-btn {
      background:#007bff;
      color:white;
      padding:8px 12px;
      border-radius:5px;
      text-decoration:none;
      font-size:14px;
    }

    .product {
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid #ddd;
      padding:10px 0;
    }

    .product img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
    }

    .info {
      flex:1;
      margin-left:15px;
    }

    button {
      margin-left:10px;
      padding:8px 12px;
      border:none;
      border-radius:5px;
      cursor:pointer;
    }

    .copy {
      background:#007bff;
      color:white;
    }

    .orders {
      background:#28a745;
      color:white;
    }

    #status {
      text-align:center;
      margin-top:10px;
      color:green;
    }
  </style>
</head>

<body>

<!-- ============ NAV BAR ============ -->
<div class="navbar">
  <div class="nav-left">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ§Ø¬Ø±</div>

  <div class="nav-links">
    <a href="dashboard.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="notifications.html">ğŸ”” Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</a>
    <a href="settings.html">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
    <a href="login.html">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</a>
  </div>
</div>

<!-- ============ CONTENT ============ -->
<div class="container">

  <div class="top-actions">
    <div>
      <h2>ğŸ“¦ Ù…Ù†ØªØ¬Ø§ØªÙŠ</h2>
      <p>Ù…Ø¹Ø±Ù‘Ù Ø§Ù„ØªØ§Ø¬Ø±: <b>1</b></p>
    </div>

    <a class="add-btn" href="addProduct.html">â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</a>
  </div>

  <div id="products"></div>

  <p id="status"></p>
</div>

<script>
const merchantId = 1;

fetch(`http://localhost:3000/merchants/${merchantId}/products`)
  .then(res => res.json())
  .then(products => {
    const box = document.getElementById("products");

    if (products.length === 0) {
      box.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯.</p>";
      return;
    }

    products.forEach(p => {
      const div = document.createElement("div");
      div.className = "product";

      const link = `http://localhost:3000/order.html?link=${p.orderLink}`;

      div.innerHTML = `
        <img src="http://localhost:3000${p.image || ''}" 
             onerror="this.src='https://via.placeholder.com/80'">

        <div class="info">
          <b>${p.name}</b><br>
          ${p.price} Ø¯Ø¬
        </div>

        <div>
          <button class="copy" onclick="copyLink('${link}')">
            Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„Ø·Ù„Ø¨
          </button>

          <button class="orders" 
            onclick="window.location='orders.html?productId=${p.id}'">
            Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
          </button>
        </div>
      `;

      box.appendChild(div);
    });
  });

function copyLink(text){
  navigator.clipboard.writeText(text);
  document.getElementById("status").textContent =
    "ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­ âœ…";
}
</script>

</body>
</html>
